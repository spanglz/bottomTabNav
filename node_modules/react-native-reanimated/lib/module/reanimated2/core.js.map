{"version":3,"names":["NativeReanimatedModule","Platform","nativeShouldBeMock","shouldBeUseWeb","isWeb","global","_setGlobalConsole","undefined","testWorklet","throwUninitializedReanimatedException","Error","checkPluginState","throwError","__workletHash","isConfigured","isConfiguredCheck","pushFrame","frame","requestFrame","native","requestAnimationFrame","_WORKLET","_log","s","console","log","runOnUI","worklet","makeShareable","value","getViewProp","viewTag","propName","_IS_FABRIC","Promise","resolve","reject","result","substr","_getTimestamp","getTimestamp","_frameTimestamp","_eventTimestamp","_getCurrentTime","OS","workletValueSetter","previousAnimation","_animation","cancelled","onFrame","animation","_value","current","isHigherOrder","callback","initializeAnimation","timestamp","onStart","step","finished","workletValueSetterJS","_setValue","makeMutable","makeRemote","object","startMapper","mapper","inputs","outputs","updater","viewDescriptors","stopMapper","mapperId","runOnJS","fun","__callAsync","installCoreFunctions","capturableConsole","debug","warn","error","info","featuresConfig","enableLayoutAnimations","setByUser","flag","isCallByUser","configureProps","uiProps","nativeProps","jestResetJsReanimatedModule","jestResetModule"],"sources":["core.ts"],"sourcesContent":["/* global _WORKLET _getCurrentTime _frameTimestamp _eventTimestamp _setGlobalConsole */\nimport NativeReanimatedModule from './NativeReanimated';\nimport { Platform } from 'react-native';\nimport { nativeShouldBeMock, shouldBeUseWeb, isWeb } from './PlatformChecker';\nimport {\n  BasicWorkletFunction,\n  ComplexWorkletFunction,\n  SharedValue,\n  AnimationObject,\n  AnimatableValue,\n  Timestamp,\n} from './commonTypes';\nimport { Descriptor } from './hook/commonTypes';\nimport JSReanimated from './js-reanimated/JSReanimated';\n\nif (global._setGlobalConsole === undefined) {\n  // it can happen when Reanimated plugin wasn't added, but the user uses the only API from version 1\n  global._setGlobalConsole = () => {\n    // noop\n  };\n}\n\nexport type ReanimatedConsole = Pick<\n  Console,\n  'debug' | 'log' | 'warn' | 'info' | 'error'\n>;\n\nexport type WorkletValue =\n  | (() => AnimationObject)\n  | AnimationObject\n  | AnimatableValue\n  | Descriptor;\ninterface WorkletValueSetterContext {\n  _animation?: AnimationObject | null;\n  _value?: AnimatableValue | Descriptor;\n  value?: AnimatableValue;\n  _setValue?: (val: AnimatableValue | Descriptor) => void;\n}\n\nconst testWorklet: BasicWorkletFunction<void> = () => {\n  'worklet';\n};\n\nconst throwUninitializedReanimatedException = () => {\n  throw new Error(\n    \"Failed to initialize react-native-reanimated library, make sure you followed installation steps here: https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/installation/ \\n1) Make sure reanimated's babel plugin is installed in your babel.config.js (you should have 'react-native-reanimated/plugin' listed there - also see the above link for details) \\n2) Make sure you reset build cache after updating the config, run: yarn start --reset-cache\"\n  );\n};\n\nexport const checkPluginState: (throwError: boolean) => boolean = (\n  throwError = true\n) => {\n  if (!testWorklet.__workletHash && !shouldBeUseWeb()) {\n    if (throwError) {\n      throwUninitializedReanimatedException();\n    }\n    return false;\n  }\n  return true;\n};\n\nexport const isConfigured: (throwError?: boolean) => boolean = (\n  throwError = false\n) => {\n  return checkPluginState(throwError);\n};\n\nexport const isConfiguredCheck: () => void = () => {\n  checkPluginState(true);\n};\n\nfunction pushFrame(frame: (timestamp: Timestamp) => void): void {\n  (NativeReanimatedModule as JSReanimated).pushFrame(frame);\n}\n\nexport function requestFrame(frame: (timestamp: Timestamp) => void): void {\n  'worklet';\n  if (NativeReanimatedModule.native) {\n    requestAnimationFrame(frame);\n  } else {\n    pushFrame(frame);\n  }\n}\n\nglobal._WORKLET = false;\nglobal._log = function (s: string) {\n  console.log(s);\n};\n\nexport function runOnUI<A extends any[], R>(\n  worklet: ComplexWorkletFunction<A, R>\n): (...args: A) => void {\n  return makeShareable(worklet);\n}\n\nexport function makeShareable<T>(value: T): T {\n  isConfiguredCheck();\n  return NativeReanimatedModule.makeShareable(value);\n}\n\nexport function getViewProp<T>(viewTag: string, propName: string): Promise<T> {\n  if (global._IS_FABRIC) {\n    throw new Error(\n      '[react-native-reanimated] `getViewProp` is not supported on Fabric yet'\n    );\n  }\n\n  return new Promise((resolve, reject) => {\n    return NativeReanimatedModule.getViewProp(\n      viewTag,\n      propName,\n      (result: T) => {\n        if (typeof result === 'string' && result.substr(0, 6) === 'error:') {\n          reject(result);\n        } else {\n          resolve(result);\n        }\n      }\n    );\n  });\n}\n\nlet _getTimestamp: () => number;\nif (nativeShouldBeMock()) {\n  _getTimestamp = () => {\n    return (NativeReanimatedModule as JSReanimated).getTimestamp();\n  };\n} else {\n  _getTimestamp = () => {\n    'worklet';\n    if (_frameTimestamp) {\n      return _frameTimestamp;\n    }\n    if (_eventTimestamp) {\n      return _eventTimestamp;\n    }\n    return _getCurrentTime();\n  };\n}\n\nexport function getTimestamp(): number {\n  'worklet';\n  if (Platform.OS === 'web') {\n    return (NativeReanimatedModule as JSReanimated).getTimestamp();\n  }\n  return _getTimestamp();\n}\n\nfunction workletValueSetter<T extends WorkletValue>(\n  this: WorkletValueSetterContext,\n  value: T\n): void {\n  'worklet';\n  const previousAnimation = this._animation;\n  if (previousAnimation) {\n    previousAnimation.cancelled = true;\n    this._animation = null;\n  }\n  if (\n    typeof value === 'function' ||\n    (value !== null &&\n      typeof value === 'object' &&\n      (value as AnimationObject).onFrame !== undefined)\n  ) {\n    const animation: AnimationObject =\n      typeof value === 'function'\n        ? (value as () => AnimationObject)()\n        : (value as AnimationObject);\n    // prevent setting again to the same value\n    // and triggering the mappers that treat this value as an input\n    // this happens when the animation's target value(stored in animation.current until animation.onStart is called) is set to the same value as a current one(this._value)\n    // built in animations that are not higher order(withTiming, withSpring) hold target value in .current\n    if (this._value === animation.current && !animation.isHigherOrder) {\n      animation.callback && animation.callback(true);\n      return;\n    }\n    // animated set\n    const initializeAnimation = (timestamp: number) => {\n      animation.onStart(animation, this.value, timestamp, previousAnimation);\n    };\n    initializeAnimation(getTimestamp());\n    const step = (timestamp: number) => {\n      if (animation.cancelled) {\n        animation.callback && animation.callback(false /* finished */);\n        return;\n      }\n      const finished = animation.onFrame(animation, timestamp);\n      animation.finished = true;\n      animation.timestamp = timestamp;\n      this._value = animation.current;\n      if (finished) {\n        animation.callback && animation.callback(true /* finished */);\n      } else {\n        requestAnimationFrame(step);\n      }\n    };\n\n    this._animation = animation;\n\n    if (_frameTimestamp) {\n      // frame\n      step(_frameTimestamp);\n    } else {\n      requestAnimationFrame(step);\n    }\n  } else {\n    // prevent setting again to the same value\n    // and triggering the mappers that treat this value as an input\n    if (this._value === value) {\n      return;\n    }\n    this._value = value as Descriptor | AnimatableValue;\n  }\n}\n\n// We cannot use pushFrame\n// so we use own implementation for js\nfunction workletValueSetterJS<T extends WorkletValue>(\n  this: WorkletValueSetterContext,\n  value: T\n): void {\n  const previousAnimation = this._animation;\n  if (previousAnimation) {\n    previousAnimation.cancelled = true;\n    this._animation = null;\n  }\n  if (\n    typeof value === 'function' ||\n    (value !== null &&\n      typeof value === 'object' &&\n      (value as AnimationObject).onFrame)\n  ) {\n    // animated set\n    const animation: AnimationObject =\n      typeof value === 'function'\n        ? (value as () => AnimationObject)()\n        : (value as AnimationObject);\n    let initializeAnimation: ((timestamp: number) => void) | null = (\n      timestamp: number\n    ) => {\n      animation.onStart(animation, this.value, timestamp, previousAnimation);\n    };\n    const step = (timestamp: number) => {\n      if (animation.cancelled) {\n        animation.callback && animation.callback(false /* finished */);\n        return;\n      }\n      if (initializeAnimation) {\n        initializeAnimation(timestamp);\n        initializeAnimation = null; // prevent closure from keeping ref to previous animation\n      }\n      const finished = animation.onFrame(animation, timestamp);\n      animation.timestamp = timestamp;\n      this._setValue && this._setValue(animation.current as AnimatableValue);\n      if (finished) {\n        animation.callback && animation.callback(true /* finished */);\n      } else {\n        requestFrame(step);\n      }\n    };\n\n    this._animation = animation;\n\n    requestFrame(step);\n  } else {\n    this._setValue && this._setValue(value as AnimatableValue | Descriptor);\n  }\n}\n\nexport function makeMutable<T>(value: T): SharedValue<T> {\n  isConfiguredCheck();\n  return NativeReanimatedModule.makeMutable(value);\n}\n\nexport function makeRemote<T>(object = {}): T {\n  isConfiguredCheck();\n  return NativeReanimatedModule.makeRemote(object);\n}\n\nexport function startMapper(\n  mapper: () => void,\n  inputs: any[] = [],\n  outputs: any[] = [],\n  updater: () => void = () => {\n    // noop\n  },\n  viewDescriptors: Descriptor[] | SharedValue<Descriptor[]> = []\n): number {\n  isConfiguredCheck();\n  return NativeReanimatedModule.startMapper(\n    mapper,\n    inputs,\n    outputs,\n    updater,\n    viewDescriptors\n  );\n}\n\nexport function stopMapper(mapperId: number): void {\n  NativeReanimatedModule.stopMapper(mapperId);\n}\n\nexport interface RunOnJSFunction<A extends any[], R> {\n  __callAsync?: (...args: A) => void;\n  (...args: A): R;\n}\n\nexport function runOnJS<A extends any[], R>(\n  fun: RunOnJSFunction<A, R>\n): () => void {\n  'worklet';\n  if (!_WORKLET) {\n    return fun;\n  }\n  if (!fun.__callAsync) {\n    throw new Error(\n      \"Attempting to call runOnJS with an object that is not a host function. Using runOnJS is only possible with methods that are defined on the main React-Native Javascript thread and that aren't marked as worklets\"\n    );\n  } else {\n    return fun.__callAsync;\n  }\n}\n\nNativeReanimatedModule.installCoreFunctions(\n  NativeReanimatedModule.native\n    ? (workletValueSetter as <T>(value: T) => void)\n    : (workletValueSetterJS as <T>(value: T) => void)\n);\n\nif (!isWeb() && isConfigured()) {\n  const capturableConsole = console;\n  runOnUI(() => {\n    'worklet';\n    const console = {\n      debug: runOnJS(capturableConsole.debug),\n      log: runOnJS(capturableConsole.log),\n      warn: runOnJS(capturableConsole.warn),\n      error: runOnJS(capturableConsole.error),\n      info: runOnJS(capturableConsole.info),\n    };\n    _setGlobalConsole(console);\n  })();\n}\n\ntype FeaturesConfig = {\n  enableLayoutAnimations: boolean;\n  setByUser: boolean;\n};\n\nlet featuresConfig: FeaturesConfig = {\n  enableLayoutAnimations: false,\n  setByUser: false,\n};\n\nexport function enableLayoutAnimations(\n  flag: boolean,\n  isCallByUser = true\n): void {\n  if (isCallByUser) {\n    featuresConfig = {\n      enableLayoutAnimations: flag,\n      setByUser: true,\n    };\n    NativeReanimatedModule.enableLayoutAnimations(flag);\n  } else if (\n    !featuresConfig.setByUser &&\n    featuresConfig.enableLayoutAnimations !== flag\n  ) {\n    featuresConfig.enableLayoutAnimations = flag;\n    NativeReanimatedModule.enableLayoutAnimations(flag);\n  }\n}\n\nexport function configureProps(uiProps: string[], nativeProps: string[]): void {\n  if (!nativeShouldBeMock()) {\n    NativeReanimatedModule.configureProps(uiProps, nativeProps);\n  }\n}\n\nexport function jestResetJsReanimatedModule() {\n  (NativeReanimatedModule as JSReanimated).jestResetModule();\n}\n"],"mappings":"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"}