{"version":3,"names":["useEffect","useRef","makeMutable","NativeReanimated","SensorType","useAnimatedSensor","sensorType","userConfig","ref","sensor","unregister","isAvailable","config","interval","current","sensorData","ROTATION","qw","qx","qy","qz","yaw","pitch","roll","x","y","z","id","registerSensor","unregisterSensor"],"sources":["useAnimatedSensor.ts"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport { makeMutable } from '../core';\nimport NativeReanimated from '../NativeReanimated';\nimport { SensorValue3D, SensorValueRotation } from '../commonTypes';\n\nexport enum SensorType {\n  ACCELEROMETER = 1,\n  GYROSCOPE = 2,\n  GRAVITY = 3,\n  MAGNETIC_FIELD = 4,\n  ROTATION = 5,\n}\n\nexport type SensorConfig = {\n  interval: number | 'auto';\n};\n\nexport type AnimatedSensor = {\n  sensor: SensorValue3D | SensorValueRotation | null;\n  unregister: () => void;\n  isAvailable: boolean;\n  config: SensorConfig;\n};\n\nexport function useAnimatedSensor(\n  sensorType: SensorType,\n  userConfig?: SensorConfig\n): AnimatedSensor {\n  const ref = useRef<AnimatedSensor>({\n    sensor: null,\n    unregister: () => {\n      // NOOP\n    },\n    isAvailable: false,\n    config: {\n      interval: 0,\n    },\n  });\n\n  if (ref.current.sensor === null) {\n    ref.current.config = { interval: 'auto', ...userConfig };\n    let sensorData;\n    if (sensorType === SensorType.ROTATION) {\n      sensorData = {\n        qw: 0,\n        qx: 0,\n        qy: 0,\n        qz: 0,\n        yaw: 0,\n        pitch: 0,\n        roll: 0,\n      };\n    } else {\n      sensorData = {\n        x: 0,\n        y: 0,\n        z: 0,\n      };\n    }\n    ref.current.sensor = makeMutable(sensorData) as any;\n  }\n\n  useEffect(() => {\n    ref.current.config = { interval: 'auto', ...userConfig };\n    const id = NativeReanimated.registerSensor(\n      sensorType,\n      ref.current.config.interval === 'auto' ? -1 : ref.current.config.interval,\n      ref.current.sensor as any\n    );\n\n    if (id !== -1) {\n      // if sensor is available\n      ref.current.unregister = () => NativeReanimated.unregisterSensor(id);\n      ref.current.isAvailable = true;\n    } else {\n      // if sensor is unavailable\n      ref.current.unregister = () => {\n        // NOOP\n      };\n      ref.current.isAvailable = false;\n    }\n\n    return () => {\n      ref.current.unregister();\n    };\n  }, [sensorType, userConfig]);\n\n  return ref.current;\n}\n"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SAASC,WAAT,QAA4B,SAA5B;AACA,OAAOC,gBAAP,MAA6B,qBAA7B;AAGA,WAAYC,UAAZ;;WAAYA,U;EAAAA,U,CAAAA,U;EAAAA,U,CAAAA,U;EAAAA,U,CAAAA,U;EAAAA,U,CAAAA,U;EAAAA,U,CAAAA,U;GAAAA,U,KAAAA,U;;AAmBZ,OAAO,SAASC,iBAAT,CACLC,UADK,EAELC,UAFK,EAGW;EAChB,MAAMC,GAAG,GAAGP,MAAM,CAAiB;IACjCQ,MAAM,EAAE,IADyB;IAEjCC,UAAU,EAAE,MAAM,CAChB;IACD,CAJgC;IAKjCC,WAAW,EAAE,KALoB;IAMjCC,MAAM,EAAE;MACNC,QAAQ,EAAE;IADJ;EANyB,CAAjB,CAAlB;;EAWA,IAAIL,GAAG,CAACM,OAAJ,CAAYL,MAAZ,KAAuB,IAA3B,EAAiC;IAC/BD,GAAG,CAACM,OAAJ,CAAYF,MAAZ,GAAqB;MAAEC,QAAQ,EAAE,MAAZ;MAAoB,GAAGN;IAAvB,CAArB;IACA,IAAIQ,UAAJ;;IACA,IAAIT,UAAU,KAAKF,UAAU,CAACY,QAA9B,EAAwC;MACtCD,UAAU,GAAG;QACXE,EAAE,EAAE,CADO;QAEXC,EAAE,EAAE,CAFO;QAGXC,EAAE,EAAE,CAHO;QAIXC,EAAE,EAAE,CAJO;QAKXC,GAAG,EAAE,CALM;QAMXC,KAAK,EAAE,CANI;QAOXC,IAAI,EAAE;MAPK,CAAb;IASD,CAVD,MAUO;MACLR,UAAU,GAAG;QACXS,CAAC,EAAE,CADQ;QAEXC,CAAC,EAAE,CAFQ;QAGXC,CAAC,EAAE;MAHQ,CAAb;IAKD;;IACDlB,GAAG,CAACM,OAAJ,CAAYL,MAAZ,GAAqBP,WAAW,CAACa,UAAD,CAAhC;EACD;;EAEDf,SAAS,CAAC,MAAM;IACdQ,GAAG,CAACM,OAAJ,CAAYF,MAAZ,GAAqB;MAAEC,QAAQ,EAAE,MAAZ;MAAoB,GAAGN;IAAvB,CAArB;IACA,MAAMoB,EAAE,GAAGxB,gBAAgB,CAACyB,cAAjB,CACTtB,UADS,EAETE,GAAG,CAACM,OAAJ,CAAYF,MAAZ,CAAmBC,QAAnB,KAAgC,MAAhC,GAAyC,CAAC,CAA1C,GAA8CL,GAAG,CAACM,OAAJ,CAAYF,MAAZ,CAAmBC,QAFxD,EAGTL,GAAG,CAACM,OAAJ,CAAYL,MAHH,CAAX;;IAMA,IAAIkB,EAAE,KAAK,CAAC,CAAZ,EAAe;MACb;MACAnB,GAAG,CAACM,OAAJ,CAAYJ,UAAZ,GAAyB,MAAMP,gBAAgB,CAAC0B,gBAAjB,CAAkCF,EAAlC,CAA/B;;MACAnB,GAAG,CAACM,OAAJ,CAAYH,WAAZ,GAA0B,IAA1B;IACD,CAJD,MAIO;MACL;MACAH,GAAG,CAACM,OAAJ,CAAYJ,UAAZ,GAAyB,MAAM,CAC7B;MACD,CAFD;;MAGAF,GAAG,CAACM,OAAJ,CAAYH,WAAZ,GAA0B,KAA1B;IACD;;IAED,OAAO,MAAM;MACXH,GAAG,CAACM,OAAJ,CAAYJ,UAAZ;IACD,CAFD;EAGD,CAvBQ,EAuBN,CAACJ,UAAD,EAAaC,UAAb,CAvBM,CAAT;EAyBA,OAAOC,GAAG,CAACM,OAAX;AACD"}